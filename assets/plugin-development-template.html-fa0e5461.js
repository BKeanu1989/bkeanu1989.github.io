import{_ as e,M as p,p as o,q as i,R as s,t as n,N as l,a1 as a}from"./framework-52ca566e.js";const c={},u=a(`<h1 id="plugin-development-template-database" tabindex="-1"><a class="header-anchor" href="#plugin-development-template-database" aria-hidden="true">#</a> Plugin Development Template &amp; Database</h1><h2 id="template" tabindex="-1"><a class="header-anchor" href="#template" aria-hidden="true">#</a> Template</h2><p>There are several ways to add template to wordpress. We are using the following way.</p><p>We&#39;ll create a file called in the includes directory.</p><p>class-sample-plugin-template.php</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Sample_Plugin_Template</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">custom_template</span><span class="token punctuation">(</span> <span class="token variable">$template</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">is_page_template</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">&#39;sample-plugin-template.php&#39;</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$template</span> <span class="token operator">=</span> <span class="token constant">SAMPLE_PLUGIN_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;public/templates/sample-plugin-template.php&#39;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token variable">$template</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As you might see we are using a constant. We are defining it in the main plugin file. In our case it&#39;s called sample-plugin.php</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token function">define</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;SAMPLE_PLUGIN_PATH&#39;</span><span class="token punctuation">,</span> <span class="token function">plugin_dir_path</span><span class="token punctuation">(</span> <span class="token constant">__FILE__</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Wordpress is using hooks for almost everything. So we need to do the following:</p><p>in class-sample-plugin.php</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code>	<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">defined</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">&#39;SAMPLE_PLUGIN_VERSION&#39;</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">version</span> <span class="token operator">=</span> <span class="token constant">SAMPLE_PLUGIN_VERSION</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">version</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;1.0.0&#39;</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">plugin_name</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;sample-plugin&#39;</span><span class="token punctuation">;</span>

		<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">load_dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">set_locale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">define_admin_hooks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">define_public_hooks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">define_custom_template</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">define_custom_template</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
		<span class="token variable">$custom_template</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sample_Plugin_Template</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">get_plugin_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">get_version</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">loader</span><span class="token operator">-&gt;</span><span class="token function">add_action</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;template_include&#39;</span><span class="token punctuation">,</span> <span class="token variable">$custom_template</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;custom_template&#39;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">load_dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token doc-comment comment">/**
		 * The class responsible for orchestrating the actions and filters of the
		 * core plugin.
		 */</span>
		<span class="token keyword">require_once</span> <span class="token function">plugin_dir_path</span><span class="token punctuation">(</span> <span class="token function">dirname</span><span class="token punctuation">(</span> <span class="token constant">__FILE__</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;includes/class-sample-plugin-loader.php&#39;</span><span class="token punctuation">;</span>

		<span class="token doc-comment comment">/**
		 * The class responsible for defining internationalization functionality
		 * of the plugin.
		 */</span>
		<span class="token keyword">require_once</span> <span class="token function">plugin_dir_path</span><span class="token punctuation">(</span> <span class="token function">dirname</span><span class="token punctuation">(</span> <span class="token constant">__FILE__</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;includes/class-sample-plugin-i18n.php&#39;</span><span class="token punctuation">;</span>

		<span class="token doc-comment comment">/**
		 * The class responsible for defining all actions that occur in the admin area.
		 */</span>
		<span class="token keyword">require_once</span> <span class="token function">plugin_dir_path</span><span class="token punctuation">(</span> <span class="token function">dirname</span><span class="token punctuation">(</span> <span class="token constant">__FILE__</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;admin/class-sample-plugin-admin.php&#39;</span><span class="token punctuation">;</span>

		<span class="token doc-comment comment">/**
		 * The class responsible for defining all actions that occur in the public-facing
		 * side of the site.
		 */</span>
		<span class="token keyword">require_once</span> <span class="token function">plugin_dir_path</span><span class="token punctuation">(</span> <span class="token function">dirname</span><span class="token punctuation">(</span> <span class="token constant">__FILE__</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;public/class-sample-plugin-public.php&#39;</span><span class="token punctuation">;</span>

        <span class="token keyword">require_once</span> <span class="token function">plugin_dir_path</span><span class="token punctuation">(</span> <span class="token function">dirname</span><span class="token punctuation">(</span> <span class="token constant">__FILE__</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;includes/class-sample-plugin-template.php&#39;</span><span class="token punctuation">;</span>

		<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">loader</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sample_Plugin_Loader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="database" tabindex="-1"><a class="header-anchor" href="#database" aria-hidden="true">#</a> Database</h2>`,12),r={href:"https://getcomposer.org/",target:"_blank",rel:"noopener noreferrer"},d=a(`<p>We&#39;ll create a directory called &#39;src/Sample&#39; in our plugin root.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">namespace</span> <span class="token package">Sample</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Sample<span class="token punctuation">\\</span>Helpers</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">DatabaseTable</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token constant">VERSION</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;1.0.0&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token constant">TABLE_NAME</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;geschlossen_morgen&#39;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">get_table_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword">global</span> <span class="token variable">$wpdb</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token property">prefix</span> <span class="token operator">.</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token constant">TABLE_NAME</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">install_table</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">global</span> <span class="token variable">$wpdb</span><span class="token punctuation">;</span>
            <span class="token variable">$charset_collate</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">get_charset_collate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table_name</span> <span class="token operator">=</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token function">get_table_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;CREATE TABLE IF NOT EXISTS <span class="token interpolation"><span class="token variable">$table_name</span></span> (
				\`id\` int(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
				\`order_id\` int(11) NOT NULL,
				\`first_name\` varchar(55) NOT NULL,
				\`last_name\` varchar(55) NOT NULL,
				\`ticket_code\` varchar(20) NOT NULL,
				\`email\` varchar(100) NOT NULL DEFAULT &#39;&#39;,
				\`activated\` BOOLEAN NOT NULL DEFAULT 0,
				\`birth_date\` varchar(10) NOT NULL DEFAULT &#39;&#39;,
				\`via_admin\` BOOLEAN NOT NULL DEFAULT 0
			) <span class="token interpolation"><span class="token variable">$charset_collate</span></span>&quot;</span><span class="token punctuation">;</span>

			<span class="token keyword">require_once</span><span class="token punctuation">(</span> <span class="token constant">ABSPATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;wp-admin/includes/upgrade.php&#39;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">dbDelta</span><span class="token punctuation">(</span> <span class="token variable">$sql</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">update_option</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;geschlossen_morgen_db_version&#39;</span><span class="token punctuation">,</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token constant">VERSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name class-name-fully-qualified"><span class="token punctuation">\\</span>Throwable</span> <span class="token variable">$th</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token variable">$th</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * add_new
     * 
     * We are just setting the ticket code here for full flexibility
     * Firstname, lastname &amp; birthdate will be set later.
     * 
     * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">]</span></span> <span class="token parameter">$order_id</span>
     * <span class="token keyword">@return</span> <span class="token class-name"><span class="token keyword">void</span></span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">add_new</span><span class="token punctuation">(</span><span class="token variable">$order_id</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword">global</span> <span class="token variable">$wpdb</span><span class="token punctuation">;</span>
        <span class="token variable">$table_name</span> <span class="token operator">=</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token function">get_table_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$contains_rave_product</span> <span class="token operator">=</span> <span class="token class-name static-context">Helpers</span><span class="token operator">::</span><span class="token function">is_rave_order</span><span class="token punctuation">(</span><span class="token variable">$order_id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$contains_rave_product</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token variable">$ticket_code</span> <span class="token operator">=</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token variable">$table_name</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;order_id&#39;</span> <span class="token operator">=&gt;</span>  <span class="token variable">$order_id</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;first_name&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;&#39;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;last_name&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;&#39;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;ticket_code&#39;</span> <span class="token operator">=&gt;</span> <span class="token variable">$ticket_code</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;email&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;&#39;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;birth_date&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;&#39;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;%d&#39;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;%s&#39;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;%s&#39;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;%s&#39;</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">is_ticket_code_valid</span><span class="token punctuation">(</span><span class="token variable">$ticket_code</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">global</span> <span class="token variable">$wpdb</span><span class="token punctuation">;</span>

        <span class="token variable">$table_name</span> <span class="token operator">=</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token function">get_table_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$found</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">get_row</span><span class="token punctuation">(</span><span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;SELECT * FROM <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$table_name</span><span class="token punctuation">}</span></span> WHERE ticket_code = %s AND activated = 0&quot;</span><span class="token punctuation">,</span> <span class="token variable">$ticket_code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$found</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">signup_user_for_rave</span><span class="token punctuation">(</span><span class="token variable">$formData</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">global</span> <span class="token variable">$wpdb</span><span class="token punctuation">;</span>
        <span class="token variable">$table_name</span> <span class="token operator">=</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token function">get_table_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$success</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">update</span><span class="token punctuation">(</span>
            <span class="token variable">$table_name</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
                <span class="token string single-quoted-string">&#39;activated&#39;</span> <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token string single-quoted-string">&#39;first_name&#39;</span> <span class="token operator">=&gt;</span> <span class="token variable">$formData</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;first_name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string single-quoted-string">&#39;last_name&#39;</span> <span class="token operator">=&gt;</span> <span class="token variable">$formData</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;last_name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string single-quoted-string">&#39;birth_date&#39;</span> <span class="token operator">=&gt;</span> <span class="token variable">$formData</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;birth_date&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string single-quoted-string">&#39;email&#39;</span> <span class="token operator">=&gt;</span> <span class="token variable">$formData</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;email&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
                <span class="token string single-quoted-string">&#39;ticket_code&#39;</span> <span class="token operator">=&gt;</span> <span class="token variable">$formData</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;ticket_code&#39;</span><span class="token punctuation">]</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
                <span class="token string single-quoted-string">&#39;%d&#39;</span><span class="token punctuation">,</span>
                <span class="token string single-quoted-string">&#39;%s&#39;</span><span class="token punctuation">,</span>
                <span class="token string single-quoted-string">&#39;%s&#39;</span><span class="token punctuation">,</span>
                <span class="token string single-quoted-string">&#39;%s&#39;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
                <span class="token string single-quoted-string">&#39;%s&#39;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$success</span> <span class="token operator">!==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

	
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">get_ticket_code_by_order_id</span><span class="token punctuation">(</span><span class="token variable">$order_id</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">global</span> <span class="token variable">$wpdb</span><span class="token punctuation">;</span>

        <span class="token variable">$table_name</span> <span class="token operator">=</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token function">get_table_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$ticket_code</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">get_var</span><span class="token punctuation">(</span><span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;SELECT ticket_code FROM <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$table_name</span><span class="token punctuation">}</span></span> WHERE order_id = %d&quot;</span><span class="token punctuation">,</span> <span class="token variable">$order_id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$ticket_code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token variable">$ticket_code</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">get_order_id_by_ticket_code</span><span class="token punctuation">(</span><span class="token variable">$ticket_code</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">global</span> <span class="token variable">$wpdb</span><span class="token punctuation">;</span>

        <span class="token variable">$table_name</span> <span class="token operator">=</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token function">get_table_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$order_id</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">get_var</span><span class="token punctuation">(</span><span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;SELECT order_id FROM <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$table_name</span><span class="token punctuation">}</span></span> WHERE ticket_code = %s&quot;</span><span class="token punctuation">,</span> <span class="token variable">$ticket_code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$order_id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token variable">$order_id</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The highlighted lines handle the &#39;version control&#39; for the table. If you ever need to alter it.</p>`,3);function k(v,b){const t=p("ExternalLinkIcon");return o(),i("div",null,[u,s("p",null,[n("For our Database we'll use php namespaces. If you have experience using NPM (Node Package Manager), there is an Php equivalent called "),s("a",r,[n("Composer"),l(t)]),n(".")]),d])}const g=e(c,[["render",k],["__file","plugin-development-template.html.vue"]]);export{g as default};
